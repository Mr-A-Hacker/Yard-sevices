{% extends "base.html" %}

{% block title %}Admin Dashboard - Yard Services{% endblock %}

{% block content %}
<header style="padding:40px 20px; text-align:center;">
  <h1 style="margin:0; font-size:36px; color:#1abc9c;">Admin Dashboard</h1>
  <p style="font-size:18px; color:#ecf0f1;">Manage posts, services, customer requests, and busy days</p>
</header>

<div class="container" style="display:flex; justify-content:space-around; margin:30px; flex-wrap:wrap;">
  <!-- New Post -->
  <div class="card">
    <h2 style="color:#1abc9c;">Create a New Post</h2>
    <form method="POST" enctype="multipart/form-data">
      <input name="title" placeholder="Post Title">
      <textarea name="content" placeholder="Post Content"></textarea>
      <input type="file" name="image">
      <button type="submit">Upload Post</button>
    </form>
  </div>

  <!-- Add Service -->
  <div class="card">
    <h2 style="color:#1abc9c;">Add a New Service</h2>
    <form method="POST">
      <input name="new_service" placeholder="Service Name">
      <input name="new_price" type="number" placeholder="Price">
      <button type="submit">Add Service</button>
    </form>
  </div>

  <!-- Update Price -->
  <div class="card">
    <h2 style="color:#1abc9c;">Update Service Price</h2>
    <form method="POST">
      <select name="update_service">
        {% for service, price in services.items() %}
          <option value="{{ service }}">{{ service }} (${{ price }})</option>
        {% endfor %}
      </select>
      <input name="updated_price" type="number" placeholder="New Price">
      <button type="submit">Update Price</button>
    </form>
  </div>

  <!-- Delete Service -->
  <div class="card">
    <h2 style="color:#e74c3c;">Delete a Service</h2>
    <form method="POST">
      <select name="delete_service">
        {% for service, price in services.items() %}
          <option value="{{ service }}">{{ service }} (${{ price }})</option>
        {% endfor %}
      </select>
      <button type="submit" style="background:#e74c3c;">Delete Service</button>
    </form>
  </div>

  <!-- Mark Busy Day -->
  <div class="card">
    <h2 style="color:#e74c3c;">Mark Busy Day</h2>
    <form method="POST">
      <input type="date" name="busy_day" required>
      <button type="submit" style="background:#e74c3c;">Block This Day</button>
    </form>
  </div>
</div>

<!-- Current Posts -->
<div class="posts">
  <h2>Current Posts</h2>
  {% for post in posts %}
    <div class="post">
      <h3 style="color:#1abc9c;">{{ post.title }}</h3>
      <p>{{ post.content }}</p>
      {% if post.image %}
        <img src="{{ url_for('static', filename='uploads/' + post.image) }}" style="max-width:100%; border-radius:5px;">
      {% endif %}
      <form method="POST" style="margin-top:10px;">
        <input type="hidden" name="delete_post" value="{{ loop.index0 }}">
        <button type="submit" style="background:#e74c3c;">Delete Post</button>
      </form>
    </div>
    <hr style="border:none; border-top:1px solid rgba(255,255,255,0.2);">
  {% endfor %}
</div>

<!-- Busy Days List -->
<div class="submissions">
  <h2>Busy Days</h2>
  <ul>
    {% for day in busy_days %}
      <li>ðŸ“… {{ day }}</li>
    {% endfor %}
  </ul>
</div>

<!-- Submissions Table -->
<div class="submissions">
  <h2>Service Requests</h2>
  <table>
    <tr>
      <th>User</th>
      <th>Address</th>
      <th>Phone</th>
      <th>Service</th>
      <th>Cost</th>
      <th>Day</th>
      <th>Time</th>
      <th>Note</th>
      <th>Action</th>
    </tr>
    {% for sub in submissions %}
    <tr>
      <td>{{ sub.user }}</td>
      <td>{{ sub.address }}</td>
      <td>{{ sub.phone }}</td>
      <td>{{ sub.service }}</td>
      <td>${{ sub.cost }}</td>
      <td>{{ sub.day }}</td>
      <td>{{ sub.time }}</td>
      <td>{{ sub.note }}</td>
      <td>
        <form method="POST">
          <input type="hidden" name="delete_submission" value="{{ loop.index0 }}">
          <button type="submit" style="background:#e74c3c; color:white; border:none; padding:6px 10px; border-radius:6px; cursor:pointer;">
            Delete
          </button>
        </form>
      </td>
    </tr>
    {% endfor %}
  </table>
</div>
{% endblock %}
